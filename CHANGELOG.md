# Changelog

Все значимые изменения проекта Matrix CLI будут задокументированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/).

## [Unreleased]

#### Запланировано
- Добавить обработку изменения размера терминала

## [0.3.3] (2026-02-14)
### Улучшение теста FPS

#### Добавлено
- **Гибкий FPS-тест**: Новый параметр `--max-frames INT` для установки произвольного количества кадров при замере производительности (по умолчанию — 500). Работает только вместе с флагом `-f`.
- **Номер кадра в тесте FPS**: Вывод текущего кадра и их общего количества при тесте FPS (вида `1/500 frames`). Теперь видно, сколько прошло, и сколько осталось.
- **Проверка зависимостей**: Для режима `-f` теперь требуется `bc` (калькулятор для точного расчёта FPS).

#### Изменено
- **Улучшение подсчета FPS**: При подсчете FPS теперь используется арифметика с плавающей точкой (вместо целочисленной). Теперь значения FPS считаются гораздо точнее.
- **Русский CHANGELOG**: CHANGELOG переведен на русский язык, и будет в дальнейшем вестить на русском языке.

## [0.3.2] (2026-02-13)
### Хранение лога FPS в памяти

#### Исправлено
- **Совместимость с Android**: Режим замера FPS (`-f`) больше не пытается писать в `/tmp/matrix_fps.log`. Лог хранится в памяти, что устраняет ошибки «Read-only file system» на Android и других системах с ограниченной записью в ФС.
- **Совместимость с macOS**: Исправлен расчёт времени в FPS-тесте для macOS (совместимость с командой `date`).
- **Текст справки**: Убрано устаревшее упоминание файла лога в описании опции `--fps`.

#### Изменено
- **Внутренняя архитектура**: Хранение FPS-лога перенесено из файловой системы в глобальную переменную `FPS_LOG` для лучшей кроссплатформенности.
- **Чистота кода**: Удалена неиспользуемая переменная `FPS_LOG_FILE` и связанные с ней операции.

#### Удалено
- **Зависимость**: Скрипт больше не требует прав на запись в каталог `/tmp`.

## [0.3.1] (2026-02-13)
### Выпуск с исправлением ошибок

#### Изменено
- **Сокращение длинного имени**: Длинное имя опции `-s, --columns-step` сокращено до `--step`.
- **Вывод ошибок**: Все сообщения об ошибках теперь направляются в STDERR.

#### Добавлено
- **Валидация параметров**: Добавлена проверка, что значение для `--step` является не только целым числом, но и больше 0 (чтобы не сломать цикл анимации).
- **Улучшенный вывод**: Утилита `curl` при обновлении из репозитория теперь работает в non-silent режиме.

#### Исправлено
- **Улучшение служебных сообщений**: Внесены изменения в тексты для опций `--help` и `--update`, чтобы сделать их понятнее.
- **Форматирование кода**.

## [0.3.0] (2026-02-12)
### Добавлена опция шага колонок

#### Добавлено
- **Управление производительностью**: Новый флаг `-s, --columns-step INT` для управления шагом вывода колонок.
  - Позволяет управлять визуальным эффектом, и находить компромисс между плотностью анимации и скоростью.
  - Значение шага теперь можно менять, и оно логируется в режиме замера FPS (`-f`).

#### Исправлено
- **Несоответствие шага по умолчанию**: Ранее переменная `columns_step` по умолчанию была равна `1`, но в цикле инициализации было жёстко прописано `i+=3`. Из-за этого любые изменения шага игнорировались.
  - **Результат**: Поведение по умолчанию осталось тем же (шаг = 3), но теперь оно корректно управляется переменной `COLUMNS_STEP` и новым флагом `-s`.
- **Улучшение справки**: Значения по умолчанию теперь явно указаны в тексте справки для флагов `--delay` и `--columns-step`.
- **Опечатка**: Исправлено сообщение об ошибке для флага `--delay` (ранее ошибочно упоминался `--speed`).

#### Изменено
- **Задержка по умолчанию**: В коде явно установлена задержка `0` (поведение не изменилось).

## [0.2.1] (2026-02-09)
### Выпуск с исправлением ошибок

#### Исправлено
- **Оптимизация**: Небольшое улучшение при конкатенации строк в буфере.
- **Цветовая палитра**: Самый яркий зелёный цвет изменён для лучшего соответствия палитре.
- **README**: Небольшие исправления.
- **CHANGELOG**: Улучшено форматирование.

## [0.2.0] (2026-02-08)

#### Производительность
- **Масштабный рефакторинг рендеринга**: Замена посимвольного обновления на буферизированный вывод.
- **Ускорение в 10–30 раз**: Достигнуто ~25 FPS при разрешении 80×24 и ~5 FPS при 238×65 (терминал Gnome в полноэкранном режиме на FullHD-дисплее).

#### Добавлено
- **Режим замера FPS**: Флаг `-f, --fps` для тестирования производительности.
- **Управление задержкой кадра**: Флаг `-d, --delay` для более плавной анимации на высоких частотах обновления.
- **Отображение FPS в реальном времени**: Показывает текущую частоту кадров в углу экрана во время замера.
- **Авто-бенчмарк**: Автоматически запускает 500 кадров и выводит подробный лог производительности.

## [0.1.2] (2026-02-07)

#### Добавлено
- Опция обновления с флагом `-u, --update`.

## [0.1.1] (2026-02-07)

#### Добавлено
  - Информация о версии с флагом `-v, --version`.
  - Поддержка кроссплатформенности протестирована (Linux, macOS, Android).
  - Файл `CHANGELOG.md`, следующий формату Keep a Changelog.

## [0.1.0] (2026-02-05)

#### Добавлено
  - Начальный релиз Matrix CLI.
  - Базовая анимация цифрового дождя.
  - Две цветовые схемы (зелёный/оттенки серого) с флагом `-g, --grayscale`.
  - Два набора символов (полный/только 0 и 1) с флагом `-b, --binary`.
  - Режим стирания хвостов колонок с флагом `-e, --erase`.
  - Режим тестирования цветовой палитры с флагом `-t, --test`.
  - Текст справки с флагом `-h, --help`.

[Unreleased]: https://github.com/diserere/matrix_cli/compare/v0.3.3...HEAD
[0.3.3]: https://github.com/diserere/matrix_cli/releases/tag/v0.3.3
[0.3.2]: https://github.com/diserere/matrix_cli/releases/tag/v0.3.2
[0.3.1]: https://github.com/diserere/matrix_cli/releases/tag/v0.3.1
[0.3.0]: https://github.com/diserere/matrix_cli/releases/tag/v0.3.0
[0.2.1]: https://github.com/diserere/matrix_cli/releases/tag/v0.2.1
[0.2.0]: https://github.com/diserere/matrix_cli/releases/tag/v0.2.0
[0.1.2]: https://github.com/diserere/matrix_cli/releases/tag/v0.1.2
[0.1.1]: https://github.com/diserere/matrix_cli/releases/tag/v0.1.1
[0.1.0]: https://github.com/diserere/matrix_cli/releases/tag/v0.1.0